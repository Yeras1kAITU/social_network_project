<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deployment Status - StudyConnect</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="container">
    <header class="main-header">
        <div class="logo">StudyConnect</div>
        <nav>
            <ul class="nav-links">
                <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="/status" class="active"><i class="fas fa-server"></i> Status</a></li>
                <li><a href="/crud"><i class="fas fa-database"></i> CRUD</a></li>
            </ul>
        </nav>
    </header>

    <main style="padding: 50px 2rem;">
        <div style="max-width: 800px; margin: 0 auto;">
            <div style="background: var(--card-bg); padding: 3rem; border-radius: var(--border-radius); border: 1px solid var(--card-border); text-align: center;">
                <h1 style="margin-bottom: 2rem;">Deployment Status</h1>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="status-card" style="background: var(--dark-bg); padding: 1.5rem; border-radius: 8px;">
                        <div style="font-size: 2rem; color: <%= isProduction ? '#48bb78' : '#ed8936' %>; margin-bottom: 1rem;">
                            <i class="fas fa-<%= isProduction ? 'cloud' : 'laptop-code' %>"></i>
                        </div>
                        <h3>Environment</h3>
                        <p style="color: var(--text-secondary);"><%= isProduction ? 'Production' : 'Development' %></p>
                    </div>

                    <div class="status-card" style="background: var(--dark-bg); padding: 1.5rem; border-radius: 8px;">
                        <div style="font-size: 2rem; color: #38b2ac; margin-bottom: 1rem;">
                            <i class="fas fa-database"></i>
                        </div>
                        <h3>Database</h3>
                        <p style="color: var(--text-secondary);"><%= dbConnected ? 'Connected' : 'Not connected' %></p>
                    </div>

                    <div class="status-card" style="background: var(--dark-bg); padding: 1.5rem; border-radius: 8px;">
                        <div style="font-size: 2rem; color: #4299e1; margin-bottom: 1rem;">
                            <i class="fas fa-server"></i>
                        </div>
                        <h3>Port</h3>
                        <p style="color: var(--text-secondary);"><%= PORT || 3000 %></p>
                    </div>
                </div>

                <div id="healthStatus" style="background: var(--dark-bg); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; text-align: left;">
                    <h3 style="margin-bottom: 1rem;">System Health</h3>
                    <p style="color: var(--text-secondary);">Loading health check...</p>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <a href="/crud" class="cta-button primary">
                        <i class="fas fa-database"></i> Test CRUD Operations
                    </a>
                    <a href="/api/health" target="_blank" class="cta-button secondary">
                        <i class="fas fa-heartbeat"></i> API Health Check
                    </a>
                    <a href="/" class="cta-button secondary">
                        <i class="fas fa-home"></i> Back to Home
                    </a>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>Â© 2025 StudyConnect - Deployment Status</p>
        <p>Environment: <%= NODE_ENV || 'development' %> | Port: <%= PORT || 3000 %></p>
    </footer>
</div>

<script>
    async function checkHealth() {
        try {
            const response = await fetch('/api/health');
            const data = await response.json();

            const healthDiv = document.getElementById('healthStatus');
            healthDiv.innerHTML = `
                <h3 style="margin-bottom: 1rem;">System Health</h3>
                <div style="display: grid; gap: 0.5rem;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-secondary);">Status:</span>
                        <span style="color: ${data.status === 'OK' ? '#48bb78' : '#f87171'}; font-weight: 600;">
                            ${data.status}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-secondary);">Database:</span>
                        <span style="color: ${data.database?.healthy ? '#48bb78' : '#f87171'};">
                            ${data.database?.healthy ? 'Healthy' : 'Not connected'}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-secondary);">Uptime:</span>
                        <span style="color: var(--text-primary);">
                            ${Math.floor(data.uptime)} seconds
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-secondary);">Timestamp:</span>
                        <span style="color: var(--text-primary); font-size: 0.9em;">
                            ${new Date(data.timestamp).toLocaleString()}
                        </span>
                    </div>
                </div>
            `;
        } catch (error) {
            document.getElementById('healthStatus').innerHTML = `
                <h3 style="margin-bottom: 1rem;">System Health</h3>
                <p style="color: #f87171;">Error checking health status: ${error.message}</p>
            `;
        }
    }

    checkHealth();

    setInterval(checkHealth, 30000);
</script>
</body>
</html>